<!--
 * @Author: Shuai Wang
 * @Github: https://github.com/wsustcid
 * @Version: 0.0.0
 * @Date: 2022-03-08 19:13:19
 * @LastEditTime: 2022-03-10 22:19:45
-->

- [1. 百度高效研发实战训练](#1-百度高效研发实战训练)
  - [1.1 设计方法与研发流程](#11-设计方法与研发流程)
    - [1.1.1 设计方法与实践介绍](#111-设计方法与实践介绍)
    - [1.1.2 高效研发流程](#112-高效研发流程)
    - [1.1.3 研发工具链介绍](#113-研发工具链介绍)
  - [1.2 代码检查](#12-代码检查)
    - [1.2.1 代码的艺术](#121-代码的艺术)
    - [1.2.3 代码检查规则：Python语言案例详解](#123-代码检查规则python语言案例详解)
  - [1.3 单元测试](#13-单元测试)
    - [1.3.1 单元测试总体介绍](#131-单元测试总体介绍)
    - [1.3.2 Python单元测试](#132-python单元测试)
    - [1.3.3 单元测试实践](#133-单元测试实践)
  - [1.4 Code Review](#14-code-review)


# 1. 百度高效研发实战训练
主要介绍了写代码的一些行为规范，类似于学术界写论文时一些约定俗称的东西，比如不用i, we, will, 不用长难句，论文模块划分层层递进，问题描述清楚，讲故事循循善诱等。当然，这些规范只是让你“显得”专业些，但是否能写出好的论文（代码），还要看你的工作做的深不深入（算法是否好），写的是否清楚（代码实现漂亮）。这就需要大量的代码阅读和写完后不断修改。


## 1.1 设计方法与研发流程
### 1.1.1 设计方法与实践介绍
**软件设计原则**  
软件设计的目的是为了使软件在*长期*范围内能够*容易*的进行*变化*。为了达到上述目标，在软件设计时要遵循一定的设计原则：
  - 高内聚：紧密相关连的元素要放在一起
  - 低耦合：单位之间要尽可能少的关联、依赖

**Clean Code**  
即为整洁代码：是指写的代码能够在尽可能短的时间内被别人读懂，直观体现为：排版整洁；逻辑清晰；扩展性好；
  - 命名规则：主要表达它是什么，不要表达它怎么做；代码争取做到自注释，不要害怕长变量名；要使用有意义的循环迭代变量；避免缩写，尤其是拼音和非约定俗成的缩写；避免使用魔法数，即没有任何说明的数字
  - 注释：主要包括：版权信息；设计意图；警示信息；注意不要套用模版，亦无需提供历史修改记录和注释掉的代码；
  - 函数：要确保每个函数只做一件事，且都是单一职责的。可以通过将函数分别设计为骨架函数和步骤函数实现。骨架函数用于对业务逻辑和算法进行抽象描述；步骤函数则用来具体实现，一般会被隐藏起来，方便阅读调试；
  - 编码细节：注意使用自然的比较顺序；简化逻辑层次，避免多层嵌套；写三元表达式时不要出现复杂的逻辑和过长的条件；尽量缩小变量作用域的范围，越小越好；

**单元测试**  
根据测试的级别，从上到小分为系统级测试；模块级测试；最后是单元测试；单元测试因为比较底层，因此能够更早的发现问题，写单元测试时要遵循一下原则：
  - Tests As Documentation: 需要把测试写的像文档一样简洁，通过一些描述，可以清晰的知道这个测试的作用。在之后对于项目修改时，只需要查看单元测试即可。
  - Fully Automated and Self-Checking: 单元测试需要能够自检查，自校验，即通过代码编写即可知道项目是否成功，不需要认为判定；
  - 单元测试的代码要尽可能的简单，保证其不会出错

**重构**  
重构一定是为了解决业务问题的，而不是为了重构而重构；且在进行重构时，要将问题拆分成多个小的单元进行修改，以便随时同步主干上的代码，减少出错。

**配置化架构**  
  - 业务配置化改造：组件配置化：包括组件内部的配置和描述组建与组建之间关系的配置；构建DSL
  - 提高配置的开发效率
  - 降低配置的维护成本


### 1.1.2 高效研发流程
开发一起个产品，可以采用创建用户故事地图的方式，对一个完整任务进行分解、组织和计划。在具体制定计划时，可以遵循以下步骤：
  1. Big Story 进行细化讨论
  2. 按照价值和重要程度进行版本规划
  3. 确定每个版本的期望达成目标
  4. 确定每个版本的内容
  5. 团队达成共识


### 1.1.3 研发工具链介绍
研发过程遵循三个基本原则：
  - 用“精益”指引产品规划；iCafe
  - 用“敏捷”加速迭代开发；iCode
  - 用“数据”驱动持续改进；iPipe



## 1.2 代码检查
### 1.2.1 代码的艺术
写出好的代码需要比较综合的能力，包括把握问题的能力、建立模型的能力、沟通协助的能力、编码执行的能力等。在写出好的代码之前，需要建立好的品味，即知道什么是好代码，这就需要不断阅读学习好的代码。
**好代码的标准**
  - 首先需要保证代码的正确性和性能
  - 其次需要保证代码的可读和可维护性
  - 第三是代码的可运维和可运营
  - 第四是代码的可共享和可重用

**不好的代码的表现**
  - 不好的函数名：my
  - 不好的变量名：包含无意义的字符：a,b,c,j,k,temp
  - 没有注释或注释不清晰
  - 一个函数执行多个功能
  - 不好的代码样式排版
  - 难以测试的代码 

**如何写出好代码**
  - 写代码前注重需求分析和系统设计：需求分析主要用于定义系统/软件的黑盒行为，主要是外在表现；系统设计主要是设计系统/软件的白盒机制，即内部的具体操作行为；
  - 模块：模块需要有明确的功能，如何切分模块十分重要，需要符合紧内聚、松耦合的原则；可以将模块划分为数据类模块和过程类模块：数据类模块主要用于完成对数据的封装，通过模块内部变量或类的内部变量实现；过程类模块本身不含数据，可以从文件中读取数据来执行一些相关的操作；
  - 类和函数：类和函数是不同的抽象层级，比如当一些操作和该类无关时，可以单独抽离出来编写为函数，便于模块间复用
  - 关于面向对象：面向对象是一种优秀的编程方法和范式，其本质是数据的封装：要求我们写程序时从数据的角度写问题，而不是从程序执行的角度；
  - 关于函数：函数的切分仍然十分重要，一定要有单一的功能，其规模要足够小
  - 关于注释：先写注释，后写代码
  - 关于代码块：其背后隐含的时编写的逻辑、层次划分；
  - 关于命名：能够望名生义，使用下划线或驼峰


### 1.2.3 代码检查规则：Python语言案例详解
**代码检查规则四大类**  
  - 代码风格规范：
  - 引用规范：
  - 定义规范：
  - 异常处理规范：

**python 编码惯例**
  - 让模块既可被导入又可被执行： if __name__ = 'main'
  - in 运算符的使用
  - 不使用临时变量交换两个值
  - 用序列构建字符串


## 1.3 单元测试
及早发现Bug、提交Bug、解决Bug是保证产品质量的关键。
  - Bug的提交有标准的格式要求，应该包括：标题、问题描述、复现步骤、能否复现、问题来源、问题影响、补充描述等内容
  - 测试是一种核心的质量保证工作

### 1.3.1 单元测试总体介绍
单元测试是指一段代码调用另一段代码，用以检验一些假设的重要性。目前进行单元测试存在一些误区，比如
  - 用system.out输出测试结果，然后依赖人去判断测试是否正确；
  - 不使用assert对测试结果进行判断；
  - 没有边界检查；
  - 多个测试分支放入一个单元测试方法中
  - 测试case和环境相关，比如依赖已知的库、表、时间等
  - 测试方法执行有先后顺序

### 1.3.2 Python单元测试
单元测试主要用于验证函数的输出是否符合预期，聚焦于函数的逻辑和核心的算法是否正确；
单元测试框架：
  - Unittest:自带框架，无兼容性问题
  - pytest
  - Nose2

**Unittest**  
  - TestCase:测试类：包含同一个测试对象的多个测试用例
  - TestSuit:测试集：包含多个测试对象的多个测试用例；
  - Assertion:使用断言判断测试结果
  - TestFixture:为测试做的准备和清除工作
  
**单元测试的规范**
  - 所有的测试必须断言判断结果，禁止出现无断言的测试用例：assertEqual; assertNotEqual; assertTrue; assertFalse; assertRaise;
  - 测试用例需要具有自表述能力，能够见名知意：test_login_with_invalid_password()
  - 测试用例之间应该相互独立，不应该相互依赖相互调用：一个测试用例只测试一个函数的一个场景

**Coverage**
  - 用来统计单元测试覆盖率

**Mock**
  - 构造模块：需要测试模块A但需要调用的模块B暂时还未开发，此时便可以使用Mock生成一个还未写完的代码，进行相应测试
  - 改变函数逻辑：如果代码中含有结果不可预知的代码：time.time();可以使用mock返回我们期望的结果
  - 减少依赖：当所有模块都已完成，但无法保证稳定性，针对其他其他不稳定的情况，可以使用mock构造一个理性的模块，规避其他模块的问题；

### 1.3.3 单元测试实践
  - [Person.py](./src/person.py)
  - [PersonTest.py](./src/personTest.py)


## 1.4 Code Review
Codeview是提升个人代码能力非常重要的手段。bad code 的外在表现：
  - 5分钟内无法看懂
  - 需要思考才能看懂
  - 需要来回翻屏才能看懂
  - 没有空行或注释的代码

**code review的步骤：**
  - 先看系统全貌，不深究细节，迅速理清模块的划分逻辑，模块间的关系等；
  - 进入模块级别，判断模块切分是否合理，理清模块内的逻辑，明确关键数据，关键的类和函数
  - 理清类和函数内部的逻辑
  - 进入细节


**python的编程规范：**
  - 模块的划分：一个.py文件便是一个模块，每个模块都应该有特定的功能，比如配置文件的读取，网页文件的解析等
  - 数据的封装：不管理好数据，是程序错误的重要来源，数据不封装，是常见的错误
  - import:禁止使用from import 
  - 异常：使用异常前需要了解异常的行为，不要主动抛出异常，使用返回值。异常的获取强制：除非重新抛出异常，否则禁止使用except:捕获所有异常，不建议捕获Exception或standardError;常见的错误是对IO操作不捕获异常，或者捕获异常的区域很大；注意如果函数会抛出异常，需要在函数的注释中明确说明
  - 构造函数：类构造函数应该尽量简单，不能包含可能失败或过于复杂的操作；
  - 函数返回值：返回值必须小于3个，返回值超过3个时必须通过class,namedtuple/dict等具名形式进行包装；其返回的类型根据函数的语义主要有三种：逻辑判断型函数返回true/false; 操作型函数作为一个动作，返回成功或失败的结果，ok或error; 在获取数据型函数中，返回一个数据，或者返回无数据/获取数据失败；因为python数据类型较为灵活，因此一定要写好函数的注释：包括函数的功能、参数、返回值；
  - 代码不可过长
  - 空行：文件及定义之间隔两个空行，比如类或全局函数；类方法之间隔一个空行；空格：逗号，冒号，分号前不加空格；二元运算符前后各加一个空格
  - 注释：
